#!/bin/bash
[ -n "$TEWIBA" ] || exec tewiba -v "$0"

TEST tewiba verbose and err mix outputs

if [ -x tewiba ]; then tewiba=./tewiba
elif [ -x ../tewiba ]; then tewiba=../tewiba
elif command -v tewiba >/dev/null; then tewiba=tewiba
else { echo "***ABORTING: tewiba executable not found" >&2; exit 1; }
fi
export tewiba

( unset TEWIBA; $tewiba -v err-and-verbose-mix.data ) >$tmp.res 2>&1

echo '== Test: err-and-verbose-mix.data:***ERRORS:2
   == T1
   == T2
   == TE1
   ***TEST ERROR err-and-verbose-mix.data*** Error1
   e1
   == T3
   == TE2
   ***TEST ERROR err-and-verbose-mix.data*** Error2
   == T4
== ***** Total tests failed: 2 *****' >$tmp.exp

cmp -s $tmp.exp $tmp.res || TERR "Bad output!
================================= Expected: =================================
$(cat $tmp.exp)
--------------------------------- Result: -----------------------------------
$(cat $tmp.res)
============================================================================="

TEND
